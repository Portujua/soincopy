<form class="modificar" ng-controller="Guia" name="agregar" ng-submit="modificar_guia()">
	<p class="btn-volver">
		<a class="btn btn-volver" href="./#/buscarguias">&larr; Volver</a>
	</p>

	<h1 style="font-size: 20px;">Guías &rarr; Editar</h1>

	<h2>
		Guía {{ guia.codigo }} 
		<small>
			<small>
				<div class="btn-group">
					<button type="button" class="btn btn-info btn-xs" ng-show="guia.status != 2" ng-click="cambiar_estado(2)">Desactivar</button>
					<button type="button" class="btn btn-danger btn-xs" ng-show="guia.status != -1" ng-click="cambiar_estado(-1)">Rechazar</button>
					<button type="button" class="btn btn-success btn-xs" ng-show="guia.status != 1" ng-click="cambiar_estado(1)">Aprobar</button>
				</div>
			</small>
		</small>
	</h2>
	<p><span style="font-size: 16px; font-weight: bold; letter-spacing: 2px;" class="status-{{ guia.status_str }}">{{ guia.status_str }}</span></p>

	<div class="register-form" ng-show="guia">
		<p><small>(*) Campos obligatorios</small></p>

		<div class="fila">
			<p>Título (*)</p>
			<input type="text" ng-model="guia.titulo" maxlength="128" placeholder="Título" />
		</div>

		<div class="fila" ng-init="cargar_materias()">
			<p>Carreras (*)</p>
			<select class="selectpicker show-tick" data-live-search="true" title="" data-width="75%" ng-options="c.id as c.nombre for c in carreras" ng-model="guia.carrera_id" ng-change="cargar_materias()"></select>
		</div>

		<div class="fila">
			<p>Materias (*)</p>
			<select class="selectpicker show-tick" data-live-search="true" title="" data-width="75%" ng-options="c.id as c.nombre group by (c.periodo + (c.tipo_carrera == 'Semestral' ? ' semestre' : (c.tipo_carrera == 'Anual' ? ' año' : ''))) for c in materias" ng-model="guia.materia" ng-show="materias"></select>

			<span ng-hide="guia.carrera_id">Seleccione una carrera</span>
		</div>

		<div class="fila" ng-init="cargar_profesores()">
			<p>Profesor (*)</p>
			<select class="selectpicker show-tick" data-live-search="true" title="" data-width="75%" ng-options="c.id as c.nombre_completo for c in profesores" ng-model="guia.profesor_id" ng-show="profesores"></select>

			<span ng-hide="profesores">Cargando...</span>
		</div>

		<div class="fila">
			<p>Sección (*)</p>
			<input type="text" ng-model="guia.seccion" maxlength="12" placeholder="Sección" />
		</div>

		<div class="fila">
			<p>Precio (*)</p>
			<input type="number" name="precio" ng-model="guia.precio" placeholder="Precio" ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/" step="0.01" required />
		</div>

		<div class="fila">
			<p>Comentario</p>
			<textarea ng-model="guia.comentario" placeholder="Escriba un comentario.."></textarea>
		</div>

		<div class="fila" ng-hide="guia.pdf">
			<p>PDF (*)</p>
			<input type="file" ng-hide="upload_progress" />
			<button type="button" class="btn-upload btn btn-primary" ng-hide="upload_progress" ng-click="subir_pdf();">Subir</button>

			<div class="progress" ng-show="upload_progress">
				<div class="progress-bar" role="progressbar" aria-valuenow="{{ upload_progress }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ upload_progress }}%">
					{{ upload_progress }}%
				</div>
			</div>
		</div>

		<div class="fila" ng-show="guia.pdf">
			<p><a class="btn btn-primary" style="font-size: 10px; margin-top: -5px;" href="" ng-click="ver_pdf(guia.pdf)">Ver PDF</a></p>
			<button type="button" ng-if="loginService.getCurrentUser().eliminar_pdf_guias" class="btn btn-danger" ng-click="eliminar_pdf()">Eliminar PDF</button>
		</div>

		<div ng-if="guia.pdf">
			<hr/>
			<h5>{{ guia.numero_paginas }} páginas, {{ guia.numero_hojas }} hojas</h5>

			<div class="fila">
				<p>Material asociado (*)</p>
				<select class="selectpicker show-tick" data-live-search="true" title="" data-width="75%" ng-options="c.id as c.nombre for c in materiales" ng-model="guia.producto.id" required></select>

				<script type="text/javascript">
					setTimeout(function(){
						$('.selectpicker').selectpicker('refresh');
					}, 500);
				</script>
			</div>

			<div class="fila">
				<p>Número de impresiones (*)</p>
				<input type="number" name="producto_cantidad" ng-model="guia.producto.cantidad" required />
			</div>
		</div>

		<div class="fila text-center">
			<button class="btn btn-primary btn-lg" type="submit" ng-disabled="agregar.$invalid">Aceptar</button>
		</div>
	</div>
</form>