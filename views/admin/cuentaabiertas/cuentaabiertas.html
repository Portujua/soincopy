<div class="seccion" ng-controller="CuentaAbierta">
	<h1 style="font-size: 20px;">Cuentas abiertas</h1>
	<p>
		<a href="./#/cuentaabiertas/agregar" class="btn btn-link" ng-show="loginService.getCurrentUser().cuentaabiertas_agregar">Agregar cuenta abierta</a>
	</p>

	<p>
		Buscar cuenta abierta <input type="text" class="input_busqueda" ng-model="busqueda" ng-init="busqueda = ''" placeholder="Use cualquier campo para buscar" /> 
		<input type="checkbox" ng-model="solo_activos" ng-init="solo_activos = false;" /> Ver solo habilitados
	</p>

	<table class="table table-stripped table-fixed-style">
		<thead>
			<th ng-show="loginService.getCurrentUser().cuentaabiertas_editar || loginService.getCurrentUser().cuentaabiertas_deshabilitar">&nbsp;</th>
			<th class="text-center">Nombre</th>
			<th class="text-center">Personas autorizadas</th>
			<th class="text-center">Vence</th>
			<th class="text-center">Total Bs.</th>
			<th class="text-center">Estado</th>
		</thead>
		<tbody>
			<tr ng-repeat="p in cuentaabiertas" 
				ng-if="
					(p.nombre.indexOf(busqueda) != -1)

					&& (solo_activos == false || p.estado == 1)
				"
				class="{{ p.estado == 0 ? 'bg-danger' : '' }}">
				<td ng-show="loginService.getCurrentUser().cuentaabiertas_editar || loginService.getCurrentUser().cuentaabiertas_deshabilitar" class="text-center">
					<div class="btn-group">
						<a ng-show="loginService.getCurrentUser().cuentaabiertas_editar" href="./#/cuentaabiertas/editar/{{ p.id }}">
							<span class="glyphicon glyphicon-pencil" aria-hidden="true" title="Editar" data-toggle="tooltip" data-placement="top"></span>
						</a>

						<span ng-click="cambiar_estado(p.id, 0)" class="glyphicon glyphicon-remove" aria-hidden="true" ng-show="loginService.getCurrentUser().cuentaabiertas_deshabilitar && p.estado == 1" title="Deshabilitar" style="color: #c9302c !important;" data-toggle="tooltip" data-placement="top"></span>
						<span ng-click="cambiar_estado(p.id, 1)" class="glyphicon glyphicon-ok" aria-hidden="true" ng-show="loginService.getCurrentUser().cuentaabiertas_deshabilitar && p.estado == 0" title="Habilitar" style="color: #449d44 !important;" data-toggle="tooltip" data-placement="top"></span>
					</div>
				</td>
				<td class="text-center">{{ p.nombre }}</td>
				<td class="text-center">
						<p ng-repeat="persona in p.personas">{{ persona.nombre_completo }} C.I. {{ persona.cedula }}</p>
					</td>
				<td class="text-center">
					{{ p.vence_el }}<br/>
					<strong>{{ p.vencido == 1 ? 'VENCIDO' : '' }}</strong>
				</td>
				<td class="text-center">{{ p.total_cuenta | currency:'Bs. ' }}</td>
				<td class="text-center">{{ p.estado == 1 ? 'Habilitado' : 'Deshabilitado' }}</td>

				<script> $('[data-toggle="tooltip"]').tooltip(); </script>
			</tr>
		</tbody>
	</table>
</div>